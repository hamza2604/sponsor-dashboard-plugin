<?php
// Prevent direct access
if (!defined('ABSPATH')) {
exit;
}
// Create database table on plugin activation
register_activation_hook(SDP_PLUGIN_DIR . 'sponsor-dashboard-plugin.php', 'sdp_create_tables');
function sdp_create_tables() {
global $wpdb;
$table_name = $wpdb->prefix . 'sponsor_orders';
$charset_collate = $wpdb->get_charset_collate();
$sql = "CREATE TABLE $table_name (
order_id BIGINT(20) AUTO_INCREMENT PRIMARY KEY,
user_id BIGINT(20),
service_id BIGINT(20),
quantity INT,
total DECIMAL(10,2),
status VARCHAR(20) DEFAULT 'Pending',
screenshot_url VARCHAR(255),
note TEXT,
link VARCHAR(255),
order_date DATETIME DEFAULT CURRENT_TIMESTAMP
) $charset_collate;";
require_once ABSPATH . 'wp-admin/includes/upgrade.php';
dbDelta($sql);
}
// Register custom post type for services
add_action('init', 'sdp_register_service_cpt');
function sdp_register_service_cpt() {
register_post_type('sponsor_services', [
'labels' => [
'name' => 'Services',
'singular_name' => 'Service',
],
'public' => false,
'show_ui' => true,
'supports' => ['title'],
'menu_icon' => 'dashicons-admin-tools',
]);
}